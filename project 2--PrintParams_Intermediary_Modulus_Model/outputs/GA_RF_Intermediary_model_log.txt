开始中介效应GA-RF模型分析，日志将保存到 outputs\GA_RF_Intermediary_model_log.txt
开始时间: 2025-07-29 05:02:04
==================================================
数据准备完成:
- 包含的特征: ['printing_temperature', 'feed_rate', 'printing_speed', 'Height', 'Width', 'Experiment_mean(MPa)']
- 打印参数(自变量): ['printing_temperature', 'feed_rate', 'printing_speed']
- 中介变量(同时作为因变量): ['Height', 'Width']
- 目标变量: 'Experiment_mean(MPa)'

数据集划分完成:
- 训练集样本数: 33 (68.8%)
- 验证集样本数: 7 (14.6%)
- 测试集样本数: 8 (16.7%)

==================================================
1. 训练中介变量预测模型 (打印参数 → 宽高)
--------------------------------------------------

Width_Predictor特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Width_Predictor特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg        	std       	min        	max         
0  	50    	-0.00284239	0.00128275	-0.00456614	-0.000720601
1  	37    	-0.00188461	0.000889124	-0.00424638	-0.000654707
2  	30    	-0.0013461 	0.000815639	-0.00459933	-0.000654707
3  	44    	-0.00121627	0.000780849	-0.00429964	-0.000654707
4  	41    	-0.00102901	0.000565482	-0.00299335	-0.000654707
5  	44    	-0.000996221	0.000671488	-0.00430164	-0.000654707
6  	39    	-0.000771443	0.000314765	-0.00275761	-0.000654707
7  	48    	-0.000804969	0.000519249	-0.00297354	-0.000654707
8  	45    	-0.000856443	0.000522712	-0.00281799	-0.000654707
9  	34    	-0.000673841	0.000100372	-0.00131305	-0.000654707
10 	44    	-0.000876938	0.000669174	-0.0038585 	-0.000654707
11 	37    	-0.000776678	0.00044162 	-0.00332547	-0.000654707
12 	45    	-0.000751268	0.000505286	-0.00419441	-0.000654707
13 	48    	-0.000705742	0.000272021	-0.00254922	-0.000654707
14 	46    	-0.000669284	0.000102037	-0.00138354	-0.000654707
15 	48    	-0.000667672	6.45377e-05	-0.00103609	-0.000654707
Width_Predictor特征集 - 最优参数: n_estimators=56, max_depth=10, min_samples_split=2, min_samples_leaf=1, max_features=None

Height_Predictor特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Height_Predictor特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg         	std        	min         	max         
0  	50    	-0.000623337	0.000264505	-0.000992246	-9.90493e-05
1  	40    	-0.000404866	0.000239795	-0.000956877	-8.79396e-05
2  	39    	-0.000257066	0.000205579	-0.000874211	-8.79396e-05
3  	33    	-0.000152111	0.000127382	-0.000798803	-8.47666e-05
4  	42    	-0.000146893	0.000159931	-0.000908508	-7.56522e-05
5  	44    	-0.000135554	0.000121108	-0.000703356	-7.56522e-05
6  	41    	-0.000143888	0.00019113 	-0.000930092	-7.56522e-05
7  	38    	-0.000139773	0.00014197 	-0.000675896	-7.52652e-05
8  	36    	-8.82222e-05	4.09398e-05	-0.000328228	-7.52652e-05
9  	43    	-9.94828e-05	7.4789e-05 	-0.000503719	-7.52652e-05
10 	44    	-0.000108689	0.000106147	-0.000675163	-7.52652e-05
11 	45    	-9.94023e-05	7.22305e-05	-0.00043296 	-7.52652e-05
12 	45    	-9.67809e-05	6.50593e-05	-0.00034024 	-7.52652e-05
13 	43    	-7.77687e-05	1.70173e-05	-0.000196837	-7.52652e-05
14 	47    	-9.269e-05  	5.68981e-05	-0.000345667	-7.52652e-05
15 	50    	-9.5116e-05 	8.80502e-05	-0.000675896	-7.52652e-05
Height_Predictor特征集 - 最优参数: n_estimators=266, max_depth=None, min_samples_split=3, min_samples_leaf=1, max_features=None

==================================================
2. 训练中介模型 (预测的宽高 → 机械模量)
--------------------------------------------------

Mediation_Model特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Mediation_Model特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg     	std    	min     	max     
0  	50    	-1313.85	133.921	-1742.44	-1094.68
1  	35    	-1206.57	80.4166	-1517.9 	-1094.68
2  	45    	-1202.59	141.054	-1778.78	-1094.68
3  	33    	-1128.38	27.0167	-1225.43	-1094.68
4  	39    	-1139.37	85.0528	-1565.94	-1094.48
5  	35    	-1141.77	106.853	-1566.07	-1097.32
6  	40    	-1151.97	116.487	-1614.96	-1094.68
7  	39    	-1142.85	118.815	-1648.78	-1094.68
8  	40    	-1141.67	128.219	-1678.28	-1094.68
9  	46    	-1109.26	52.8003	-1456.74	-1094.68
10 	49    	-1121.57	90.2688	-1570.86	-1094.68
11 	41    	-1100.25	16.4281	-1178.57	-1094.68
12 	49    	-1106.13	40.767 	-1299.47	-1094.68
13 	47    	-1103.44	41.3664	-1320.08	-1094.68
14 	46    	-1094.68	7.0961e-13	-1094.68	-1094.68
15 	46    	-1099.77	26.2664   	-1263.1 	-1094.68
Mediation_Model特征集 - 最优参数: n_estimators=89, max_depth=5, min_samples_split=4, min_samples_leaf=2, max_features=None

==================================================
3. 训练直接模型 (打印参数 → 机械模量)
--------------------------------------------------

Direct_Model特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Direct_Model特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg     	std    	min     	max     
0  	50    	-1641.03	685.174	-2813.63	-506.839
1  	35    	-1229.91	581.605	-2751.48	-489.502
2  	39    	-979.508	510.465	-2811.42	-488.794
3  	32    	-754.288	480.161	-2681.36	-488.794
4  	36    	-711.896	438.32 	-2215.22	-488.794
5  	37    	-635.27 	347.523	-1751.75	-488.794
6  	48    	-576.16 	268.027	-1704.12	-483.683
7  	35    	-564.617	330.277	-2681.36	-483.683
8  	38    	-701.384	551.791	-2813.63	-483.683
9  	41    	-633.921	391.019	-2239.8 	-483.683
10 	39    	-553.751	340.178	-2836.45	-480.184
11 	41    	-529.822	229.394	-2039.78	-480.184
12 	45    	-507.048	121.006	-1252.86	-480.184
13 	49    	-599.516	414.928	-2679.01	-480.184
14 	44    	-482.633	1.60361	-483.683	-480.184
15 	50    	-496.772	105.36 	-1233.98	-480.184
Direct_Model特征集 - 最优参数: n_estimators=149, max_depth=20, min_samples_split=2, min_samples_leaf=1, max_features=log2

==================================================
4. 训练混合模型 (打印参数 + 实际宽高 → 机械模量)
--------------------------------------------------

Hybrid_Model特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Hybrid_Model特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg     	std   	min     	max     
0  	50    	-1217.64	90.764	-1397.42	-990.297
1  	41    	-1130.94	80.1618	-1246.62	-971.47 
2  	26    	-1092.85	84.2376	-1309.23	-943.821
3  	41    	-1043.9 	79.0629	-1313.04	-943.821
4  	34    	-1030.64	98.7442	-1378.55	-943.821
5  	46    	-1030.89	95.1922	-1378.55	-943.821
6  	39    	-979.943	41.9801	-1214.58	-943.821
7  	49    	-1002.04	88.7039	-1297.97	-943.821
8  	44    	-996.302	96.2001	-1361.41	-943.821
9  	38    	-997.54 	117.143	-1386.42	-943.821
10 	46    	-958.418	51.9643	-1184.77	-943.821
11 	44    	-972.671	101.434	-1408   	-943.821
12 	42    	-963.13 	74.406 	-1378.55	-943.821
13 	46    	-958.8  	67.4015	-1378.55	-943.821
14 	47    	-947.078	23.3451	-1110.45	-940.031
15 	44    	-957.314	67.574 	-1294.56	-933.495
Hybrid_Model特征集 - 最优参数: n_estimators=139, max_depth=None, min_samples_split=2, min_samples_leaf=1, max_features=sqrt

模型已保存至:
- 宽度预测模型: models\ga_rf_width_predictor.joblib
- 高度预测模型: models\ga_rf_height_predictor.joblib
- 中介模型: models\ga_rf_mediation_model.joblib
- 直接模型: models\ga_rf_direct_model.joblib
- 混合模型: models\ga_rf_hybrid_model.joblib

==================================================
5. 模型测试集评估结果
--------------------------------------------------

中介模型评估:
  均方误差 (MSE): 2192.0461
  决定系数 (R2): 0.5470
  平均绝对误差 (MAE): 27.8177
  中位数绝对误差 (MedAE): 14.5907

直接模型评估:
  均方误差 (MSE): 1313.9134
  决定系数 (R2): 0.7285
  平均绝对误差 (MAE): 27.1303
  中位数绝对误差 (MedAE): 22.1003

混合模型评估:
  均方误差 (MSE): 1261.5232
  决定系数 (R2): 0.7393
  平均绝对误差 (MAE): 23.5092
  中位数绝对误差 (MedAE): 16.4085

==================================================
6. 中介效应分析结果
--------------------------------------------------
总效应 (直接模型R²): 0.7285
直接效应 (控制宽高后): 0.1923
中介效应 (通过宽高): 0.5362
中介比例 (中介效应/总效应): 73.61%
特征重要性图已保存至: outputs\GA_RF_Intermediary_feature_importance.png
预测散点图已保存至: outputs\GA_RF_Intermediary_prediction_scatter.png
评估指标对比图已保存至: outputs\GA_RF_Intermediary_metrics_comparison.png

所有预测结果已导出至: prediction_results\GA_RF_Intermediary_predictions.xlsx

==================================================
模型训练完成！总运行时间: 0:07:37
结束时间: 2025-07-29 05:09:41
详细日志已保存到: outputs\GA_RF_Intermediary_model_log.txt
