开始XGBoost中介效应分析实验，日志将保存到 outputs\XGB_Intermediary_effect_analysis_log.txt
开始时间: 2025-07-29 05:13:15
==================================================
数据准备完成:
- 包含的特征: ['printing_temperature', 'feed_rate', 'printing_speed', 'Width', 'Height', 'Experiment_mean(MPa)']
- 打印参数(自变量): ['printing_temperature', 'feed_rate', 'printing_speed']
- 中介变量: ['Width', 'Height'] (同时作为打印参数的因变量)
- 目标变量: 'Experiment_mean(MPa)'
- 数据集划分比例: 训练集:验证集:测试集 = 7:1.5:1.5

将使用以下种子进行实验: [2520155, 2520156, 2520157, 2520158, 2520159]

==============================
开始第 1/5 次实验，种子值: 2520155
==============================

第 1 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7052
直接模型 - 测试集R²: 0.7522
混合模型 - 测试集R²: 0.7208

==============================
开始第 2/5 次实验，种子值: 2520156
==============================

第 2 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.3812
直接模型 - 测试集R²: 0.4340
混合模型 - 测试集R²: 0.4998

==============================
开始第 3/5 次实验，种子值: 2520157
==============================

第 3 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.5488
直接模型 - 测试集R²: 0.8308
混合模型 - 测试集R²: 0.8579

==============================
开始第 4/5 次实验，种子值: 2520158
==============================

第 4 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.4136
直接模型 - 测试集R²: 0.4894
混合模型 - 测试集R²: 0.6586

==============================
开始第 5/5 次实验，种子值: 2520159
==============================

第 5 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.6256
直接模型 - 测试集R²: 0.3964
混合模型 - 测试集R²: 0.1710

==================================================
多次实验的平均评估结果（保留4位小数）:
==================================================

中介模型 (打印参数→宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 2364.3122
  决定系数 (R2): 0.5020
测试集平均评估:
  均方误差 (MSE): 2388.4756
  决定系数 (R2): 0.5349
  平均绝对误差 (MAE): 35.9719
  中位数绝对误差 (MedAE): 23.4797

直接模型 (打印参数直接→机械模量):
验证集平均评估:
  均方误差 (MSE): 2403.2182
  决定系数 (R2): 0.4927
测试集平均评估:
  均方误差 (MSE): 2130.1673
  决定系数 (R2): 0.5805
  平均绝对误差 (MAE): 32.2413
  中位数绝对误差 (MedAE): 19.9543

混合模型 (打印参数+宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 2472.0690
  决定系数 (R2): 0.4265
测试集平均评估:
  均方误差 (MSE): 2155.7797
  决定系数 (R2): 0.5816
  平均绝对误差 (MAE): 34.1712
  中位数绝对误差 (MedAE): 26.1428

==================================================
中介效应分析结果:
==================================================
总效应 (直接模型R²): 0.5805
直接效应 (控制宽高后): 0.0467
中介效应 (通过宽高): 0.5338
中介比例 (中介效应/总效应): 91.95%

==================================================
各模型最优参数 (最后一次实验):
==================================================

width模型最优参数:
  colsample_bytree: 0.8
  learning_rate: 0.1
  max_depth: 3
  min_child_weight: 1
  n_estimators: 50
  reg_alpha: 0
  reg_lambda: 0.5
  subsample: 1.0

height模型最优参数:
  colsample_bytree: 1.0
  learning_rate: 0.05
  max_depth: 5
  min_child_weight: 1
  n_estimators: 100
  reg_alpha: 0
  reg_lambda: 0.5
  subsample: 0.8

mediation模型最优参数:
  colsample_bytree: 0.8
  learning_rate: 0.1
  max_depth: 3
  min_child_weight: 3
  n_estimators: 200
  reg_alpha: 0.5
  reg_lambda: 0.5
  subsample: 0.8

direct模型最优参数:
  colsample_bytree: 0.8
  learning_rate: 0.05
  max_depth: 3
  min_child_weight: 1
  n_estimators: 50
  reg_alpha: 0
  reg_lambda: 0.5
  subsample: 1.0

hybrid模型最优参数:
  colsample_bytree: 1.0
  learning_rate: 0.1
  max_depth: 3
  min_child_weight: 3
  n_estimators: 100
  reg_alpha: 0.5
  reg_lambda: 1.0
  subsample: 0.8

所有预测结果已导出至: prediction_results\XGB_Intermediary_analysis_predictions.xlsx

==================================================
所有实验完成！总运行时间: 13:40:34
结束时间: 2025-07-29 18:53:50
详细日志已保存到: outputs\XGB_Intermediary_effect_analysis_log.txt
