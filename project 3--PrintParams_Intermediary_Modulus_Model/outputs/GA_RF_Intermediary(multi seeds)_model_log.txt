开始中介效应GA-RF模型分析，日志将保存到 outputs\GA_RF_Intermediary(multi seeds)_model_log.txt
开始时间: 2025-08-21 19:55:55
==================================================
数据准备完成:
- 包含的特征: ['printing_temperature', 'feed_rate', 'printing_speed', 'Height', 'Width', 'Experiment_mean(MPa)']
- 打印参数(自变量): ['printing_temperature', 'feed_rate', 'printing_speed']
- 中介变量: ['Height', 'Width']
- 目标变量: 'Experiment_mean(MPa)'
- 中介模型结构: 第一层3个输入变量，第二层5个输入变量

==============================
开始第 1/1 次实验，种子值: 2520157
==============================

Width_Predictor特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Width_Predictor特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg        	std       	min       	max         
0  	50    	-0.00434294	0.00292287	-0.0087653	-0.000270176
1  	36    	-0.00256301	0.00206693	-0.00874454	-0.000280998
2  	39    	-0.00132358	0.00113503	-0.00614483	-0.000274009
3  	39    	-0.00139445	0.0019729 	-0.00849107	-0.000243696
4  	36    	-0.000719218	0.00132897	-0.00643795	-0.000238921
5  	41    	-0.00101323 	0.00177833	-0.00861667	-0.000238921
6  	33    	-0.000779292	0.0018033 	-0.00867097	-0.000213981
7  	44    	-0.000527628	0.000990129	-0.0063469 	-0.000209367
8  	48    	-0.00040024 	0.000865038	-0.0063591 	-0.000209326
9  	41    	-0.000311439	0.000309087	-0.00165914	-0.000205835
10 	44    	-0.000481928	0.000984661	-0.00631218	-0.000205835
11 	42    	-0.000550499	0.00128361 	-0.00842614	-0.000205835
12 	41    	-0.000231862	0.000154209	-0.00130741	-0.000205835
13 	42    	-0.000452778	0.00100743 	-0.00592018	-0.000205835
14 	49    	-0.00020779 	1.2405e-05 	-0.000294581	-0.000205835
15 	43    	-0.000220539	9.77028e-05	-0.000903505	-0.000205459
Width_Predictor特征集 - 最优参数: n_estimators=100, max_depth=5, min_samples_split=8, min_samples_leaf=1, max_features=None

Height_Predictor特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Height_Predictor特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg         	std        	min        	max         
0  	50    	-0.000560375	0.000314918	-0.00107222	-0.000128029
1  	36    	-0.000364339	0.000251395	-0.00107879	-0.000132593
2  	39    	-0.000222889	0.000154412	-0.000836274	-0.000121872
3  	39    	-0.000214006	0.000189225	-0.000941877	-0.000121872
4  	36    	-0.000167271	0.000109455	-0.000653319	-0.00011767 
5  	41    	-0.000197119	0.000175541	-0.00101463 	-0.00011767 
6  	33    	-0.000188204	0.000182778	-0.00103773 	-0.00011767 
7  	44    	-0.000167032	0.000129703	-0.00080085 	-0.000115193
8  	48    	-0.000137076	7.36257e-05	-0.0006447  	-0.000115193
9  	41    	-0.000134588	6.39549e-05	-0.000453233	-0.000115193
10 	44    	-0.000146644	0.000102029	-0.000645949	-0.000115193
11 	42    	-0.000145312	0.000123987	-0.000941877	-0.000115193
12 	41    	-0.000118503	1.24418e-05	-0.000181213	-0.000115193
13 	42    	-0.000142984	0.000115405	-0.000715912	-0.000115193
14 	49    	-0.000116488	6.76846e-06	-0.000162185	-0.000115193
15 	43    	-0.000117509	1.09889e-05	-0.000174361	-0.000115193
Height_Predictor特征集 - 最优参数: n_estimators=89, max_depth=10, min_samples_split=3, min_samples_leaf=1, max_features=None

Mediation_Model特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Mediation_Model特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg     	std    	min     	max     
0  	50    	-929.678	373.222	-1415.09	-222.439
1  	36    	-634.387	330.73 	-1377.13	-222.439
2  	39    	-456.9  	228.378	-1185.83	-222.439
3  	39    	-428.824	294.84 	-1362.18	-222.439
4  	36    	-358.263	253.839	-1378.48	-212.745
5  	41    	-376.745	287.928	-1354.29	-212.745
6  	33    	-302.277	265.961	-1398.39	-195.378
7  	44    	-271.11 	166.298	-1239.6 	-195.378
8  	48    	-263.93 	169.028	-1239.6 	-195.378
9  	41    	-226.36 	85.7773	-804.737	-195.378
10 	44    	-252.518	168.024	-1212.03	-195.378
11 	42    	-279.578	229.438	-1339.8 	-195.378
12 	41    	-228.095	92.0265	-714.971	-195.378
13 	42    	-244.292	192.002	-1212.25	-195.378
14 	49    	-205.12 	42.5836	-417.018	-195.378
15 	43    	-201.018	26.2719	-332.977	-195.378
Mediation_Model特征集 - 最优参数: n_estimators=100, max_depth=10, min_samples_split=2, min_samples_leaf=1, max_features=None

Direct_Model特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Direct_Model特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg     	std    	min     	max     
0  	50    	-1815.94	817.991	-3186.62	-687.158
1  	36    	-1213.02	565.339	-2981.76	-687.158
2  	39    	-875.248	187.078	-1574.78	-687.158
3  	39    	-912.621	456.544	-2931.23	-681.287
4  	36    	-779.76 	151.019	-1298.73	-681.287
5  	41    	-843.165	380.307	-2785.72	-681.287
6  	33    	-831.358	451.951	-3035.94	-681.287
7  	44    	-779.009	265.902	-2158.87	-681.287
8  	48    	-699.755	65.098 	-1096.59	-681.287
9  	41    	-726.534	183.188	-1659.36	-681.287
10 	44    	-770.055	274.349	-2067.17	-681.287
11 	42    	-766.083	345.503	-2785.72	-681.287
12 	41    	-691.883	46.968 	-976.389	-681.287
13 	42    	-760.019	315.26 	-2264   	-681.287
14 	49    	-684.372	15.1225	-761.042	-681.287
15 	43    	-686.231	22.0527	-821.817	-681.287
Direct_Model特征集 - 最优参数: n_estimators=89, max_depth=15, min_samples_split=2, min_samples_leaf=2, max_features=None

Hybrid_Model特征集 - 遗传算法参数:
种群大小: 50
迭代代数: 15
初始交叉概率: 0.6
最终交叉概率: 0.95
初始变异概率: 0.4
最终变异概率: 0.05
Hybrid_Model特征集 - 开始遗传算法优化随机森林参数...
gen	nevals	avg    	std    	min     	max     
0  	50    	-1156.8	286.069	-1642.81	-658.114
1  	36    	-960.031	216.224	-1577.55	-694.961
2  	39    	-856.313	129.042	-1364.2 	-694.961
3  	39    	-858.264	204.016	-1606.01	-695.496
4  	36    	-810.015	158.66 	-1565.43	-693.585
5  	41    	-825.47 	191.401	-1565.7 	-639.993
6  	33    	-772.687	197.36 	-1601.55	-618.812
7  	44    	-723.128	105.736	-1260.7 	-620.564
8  	48    	-706.492	119.781	-1260.7 	-620.564
9  	41    	-655.391	54.5247	-930.543	-620.564
10 	44    	-666.144	113.102	-1293.16	-620.564
11 	42    	-680.747	167.523	-1528.44	-620.564
12 	41    	-640.965	65.4844	-945.688	-620.564
13 	42    	-660.343	142.001	-1344.62	-620.564
14 	49    	-634.063	62.3362	-1019.23	-620.564
15 	43    	-635.31 	67.7522	-996.056	-620.564
Hybrid_Model特征集 - 最优参数: n_estimators=71, max_depth=10, min_samples_split=2, min_samples_leaf=1, max_features=None

第 1 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7033
直接模型 - 测试集R²: 0.5411
混合模型 - 测试集R²: 0.5727

==================================================
多次实验的平均评估结果（保留4位小数）:
==================================================

中介模型 (打印参数→宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 195.3784
  决定系数 (R2): 0.9696
测试集平均评估:
  均方误差 (MSE): 507.5588
  决定系数 (R2): 0.7033
  平均绝对误差 (MAE): 16.9531
  中位数绝对误差 (MedAE): 8.5437

直接模型 (打印参数直接→机械模量):
验证集平均评估:
  均方误差 (MSE): 681.2870
  决定系数 (R2): 0.8939
测试集平均评估:
  均方误差 (MSE): 785.0155
  决定系数 (R2): 0.5411
  平均绝对误差 (MAE): 23.0691
  中位数绝对误差 (MedAE): 19.3528

混合模型 (打印参数+宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 618.8122
  决定系数 (R2): 0.9036
测试集平均评估:
  均方误差 (MSE): 730.9988
  决定系数 (R2): 0.5727
  平均绝对误差 (MAE): 21.5625
  中位数绝对误差 (MedAE): 20.1162

==================================================
中介效应分析结果:
==================================================
总效应 (直接模型R²): 0.5411
直接效应 (控制宽高后): -0.1306
中介效应 (通过宽高): 0.6717
中介比例 (中介效应/总效应): 124.14%
特征重要性图已保存至: outputs\GA_RF_Intermediary(multi seeds)_feature_importance.png
预测散点图已保存至: outputs\GA_RF_Intermediary(multi seeds)_predictions_scatter.png
预测结果已导出至: prediction_results\GA_RF_Intermediary(multi seeds)_analysis_predictions.xlsx

最终模型已保存至:
- 宽度预测模型: models\ga_rf(multi seeds)_width_predictor_final.joblib
- 高度预测模型: models\ga_rf(multi seeds)_height_predictor_final.joblib
- 中介模型: models\ga_rf(multi seeds)_mediation_model_final.joblib
- 直接模型: models\ga_rf(multi seeds)_direct_model_final.joblib
- 混合模型: models\ga_rf(multi seeds)_hybrid_model_final.joblib

实验完成，总运行时间: 0:08:17
结束时间: 2025-08-21 20:04:12
