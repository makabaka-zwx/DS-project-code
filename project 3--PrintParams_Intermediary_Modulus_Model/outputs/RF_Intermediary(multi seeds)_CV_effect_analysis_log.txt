开始中介效应分析实验，日志将保存到 outputs\RF_Intermediary(multi seeds)_CV_effect_analysis_log.txt
开始时间: 2025-08-26 12:11:34
==================================================
数据准备完成:
- 包含的特征: ['printing_temperature', 'feed_rate', 'printing_speed', 'Width', 'Height', 'Experiment_mean(MPa)']
- 打印参数(自变量): ['printing_temperature', 'feed_rate', 'printing_speed']
- 中介变量: ['Width', 'Height']
- 目标变量: 'Experiment_mean(MPa)'

将使用以下种子进行实验: [2520153, 2520154, 2520155, 2520156, 2520157, 2520158, 2520159, 2520160, 2520161]

==============================
开始第 1/9 次实验，种子值: 2520153
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 1 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.3993
直接模型 - 测试集R²: 0.3639
混合模型 - 测试集R²: 0.3814

==============================
开始第 2/9 次实验，种子值: 2520154
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 2 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8237
直接模型 - 测试集R²: 0.7186
混合模型 - 测试集R²: 0.8020

==============================
开始第 3/9 次实验，种子值: 2520155
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 3 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8255
直接模型 - 测试集R²: 0.8172
混合模型 - 测试集R²: 0.8007

==============================
开始第 4/9 次实验，种子值: 2520156
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 4 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7972
直接模型 - 测试集R²: 0.9109
混合模型 - 测试集R²: 0.7929

==============================
开始第 5/9 次实验，种子值: 2520157
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 5 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.6698
直接模型 - 测试集R²: 0.7704
混合模型 - 测试集R²: 0.6126

==============================
开始第 6/9 次实验，种子值: 2520158
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 6 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8143
直接模型 - 测试集R²: 0.7829
混合模型 - 测试集R²: 0.7438

==============================
开始第 7/9 次实验，种子值: 2520159
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 7 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7518
直接模型 - 测试集R²: 0.7979
混合模型 - 测试集R²: 0.6470

==============================
开始第 8/9 次实验，种子值: 2520160
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 8 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.6735
直接模型 - 测试集R²: 0.5979
混合模型 - 测试集R²: 0.6800

==============================
开始第 9/9 次实验，种子值: 2520161
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 9 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7081
直接模型 - 测试集R²: 0.7895
混合模型 - 测试集R²: 0.5562

==================================================
保存最优模型:
- 最优mediation模型 (种子 2520155, R²=0.8255) 已保存至: models\best_mediation_model_seed_2520155.pkl
- 最优direct模型 (种子 2520156, R²=0.9109) 已保存至: models\best_direct_model_seed_2520156.pkl
- 最优hybrid模型 (种子 2520154, R²=0.8020) 已保存至: models\best_hybrid_model_seed_2520154.pkl

==================================================
多次实验的统计评估结果（保留4位小数）:
==================================================

中介模型 (打印参数→宽高→机械模量):
验证集统计:
  均方误差 (MSE): 1080.4858 ± 791.9905, CV=0.7330
  决定系数 (R2): 0.7099 ± 0.1272, CV=0.1791
测试集统计:
  均方误差 (MSE): 1455.3278 ± 1548.6791, CV=1.0641
  决定系数 (R2): 0.7181 ± 0.1271, CV=0.1770
  平均绝对误差 (MAE): 24.7294 ± 10.7626, CV=0.4352
  中位数绝对误差 (MedAE): 17.1337 ± 7.5136, CV=0.4385

直接模型 (打印参数直接→机械模量):
验证集统计:
  均方误差 (MSE): 1058.1833 ± 1040.3336, CV=0.9831
  决定系数 (R2): 0.7329 ± 0.1781, CV=0.2430
测试集统计:
  均方误差 (MSE): 1579.1862 ± 1732.8605, CV=1.0973
  决定系数 (R2): 0.7277 ± 0.1507, CV=0.2071
  平均绝对误差 (MAE): 25.6439 ± 13.5639, CV=0.5289
  中位数绝对误差 (MedAE): 20.1542 ± 12.9761, CV=0.6438

混合模型 (打印参数+宽高→机械模量):
验证集统计:
  均方误差 (MSE): 1177.4500 ± 875.8853, CV=0.7439
  决定系数 (R2): 0.6773 ± 0.1983, CV=0.2928
测试集统计:
  均方误差 (MSE): 1596.1616 ± 1542.9441, CV=0.9667
  决定系数 (R2): 0.6685 ± 0.1313, CV=0.1965
  平均绝对误差 (MAE): 26.7970 ± 10.3387, CV=0.3858
  中位数绝对误差 (MedAE): 18.0370 ± 6.7276, CV=0.3730

==================================================
中介效应分析结果:
==================================================
总效应 (直接模型R²): 0.7277
直接效应 (控制宽高后): -0.0496
中介效应 (通过宽高): 0.7773
中介比例 (中介效应/总效应): 106.82%

所有预测结果已导出至: prediction_results\RF_Intermediary(multi seeds)_CV_analysis_predictions.xlsx

==================================================
所有实验完成！总运行时间: 2:15:43
结束时间: 2025-08-26 14:27:17
详细日志已保存到: outputs\RF_Intermediary(multi seeds)_CV_effect_analysis_log.txt
