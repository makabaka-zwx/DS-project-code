开始中介效应分析实验，日志将保存到 outputs\RF_Intermediary_effect_analysis_log.txt
开始时间: 2025-08-25 18:20:03
==================================================
数据准备完成:
- 包含的特征: ['printing_temperature', 'feed_rate', 'printing_speed', 'Width', 'Height', 'Experiment_mean(MPa)']
- 打印参数(自变量): ['printing_temperature', 'feed_rate', 'printing_speed']
- 中介变量: ['Width', 'Height']
- 目标变量: 'Experiment_mean(MPa)'

将使用以下种子进行实验: [2520153, 2520154, 2520155, 2520156, 2520157, 2520158, 2520159, 2520160, 2520161]

==============================
开始第 1/9 次实验，种子值: 2520153
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 1 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.3993
直接模型 - 测试集R²: 0.3639
混合模型 - 测试集R²: 0.3814

==============================
开始第 2/9 次实验，种子值: 2520154
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 2 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8237
直接模型 - 测试集R²: 0.7186
混合模型 - 测试集R²: 0.8020

==============================
开始第 3/9 次实验，种子值: 2520155
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 3 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8255
直接模型 - 测试集R²: 0.8172
混合模型 - 测试集R²: 0.8007

==============================
开始第 4/9 次实验，种子值: 2520156
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 4 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7972
直接模型 - 测试集R²: 0.9109
混合模型 - 测试集R²: 0.7929

==============================
开始第 5/9 次实验，种子值: 2520157
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 5 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.6698
直接模型 - 测试集R²: 0.7704
混合模型 - 测试集R²: 0.6126

==============================
开始第 6/9 次实验，种子值: 2520158
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 6 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8143
直接模型 - 测试集R²: 0.7829
混合模型 - 测试集R²: 0.7438

==============================
开始第 7/9 次实验，种子值: 2520159
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 7 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7518
直接模型 - 测试集R²: 0.7979
混合模型 - 测试集R²: 0.6470

==============================
开始第 8/9 次实验，种子值: 2520160
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 8 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.6735
直接模型 - 测试集R²: 0.5979
混合模型 - 测试集R²: 0.6800

==============================
开始第 9/9 次实验，种子值: 2520161
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 9 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7081
直接模型 - 测试集R²: 0.7895
混合模型 - 测试集R²: 0.5562

==================================================
多次实验的平均评估结果（保留4位小数）:
==================================================

中介模型 (打印参数→宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 1080.4858
  决定系数 (R2): 0.7099
测试集平均评估:
  均方误差 (MSE): 1455.3278
  决定系数 (R2): 0.7181
  平均绝对误差 (MAE): 24.7294
  中位数绝对误差 (MedAE): 17.1337

直接模型 (打印参数直接→机械模量):
验证集平均评估:
  均方误差 (MSE): 1058.1833
  决定系数 (R2): 0.7329
测试集平均评估:
  均方误差 (MSE): 1579.1862
  决定系数 (R2): 0.7277
  平均绝对误差 (MAE): 25.6439
  中位数绝对误差 (MedAE): 20.1542

混合模型 (打印参数+宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 1177.4500
  决定系数 (R2): 0.6773
测试集平均评估:
  均方误差 (MSE): 1596.1616
  决定系数 (R2): 0.6685
  平均绝对误差 (MAE): 26.7970
  中位数绝对误差 (MedAE): 18.0370

==================================================
中介效应分析结果:
==================================================
总效应 (直接模型R²): 0.7277
直接效应 (控制宽高后): -0.0496
中介效应 (通过宽高): 0.7773
中介比例 (中介效应/总效应): 106.82%

所有预测结果已导出至: prediction_results\RF_Intermediary_analysis_predictions.xlsx

==================================================
所有实验完成！总运行时间: 9:22:28
结束时间: 2025-08-26 03:42:31
详细日志已保存到: outputs\RF_Intermediary_effect_analysis_log.txt
