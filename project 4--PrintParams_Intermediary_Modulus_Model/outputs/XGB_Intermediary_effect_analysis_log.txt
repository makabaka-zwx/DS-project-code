开始XGBoost中介效应分析实验，日志将保存到 outputs\XGB_Intermediary_effect_analysis_log.txt
开始时间: 2025-08-25 18:40:11
==================================================
数据准备完成:
- 包含的特征: ['printing_temperature', 'feed_rate', 'printing_speed', 'Width', 'Height', 'Experiment_mean(MPa)']
- 打印参数(自变量): ['printing_temperature', 'feed_rate', 'printing_speed']
- 中介变量: ['Width', 'Height'] (同时作为打印参数的因变量)
- 目标变量: 'Experiment_mean(MPa)'
- 数据集划分比例: 训练集:验证集:测试集 = 7:1.5:1.5 (基于目标变量的分层抽样)

将使用以下种子进行实验: [2520153, 2520154, 2520155, 2520156, 2520157, 2520158, 2520159, 2520160, 2520161]

==============================
开始第 1/9 次实验，种子值: 2520153
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 1 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.3761
直接模型 - 测试集R²: 0.3983
混合模型 - 测试集R²: 0.3766

==============================
开始第 2/9 次实验，种子值: 2520154
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 2 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8238
直接模型 - 测试集R²: 0.6949
混合模型 - 测试集R²: 0.8705

==============================
开始第 3/9 次实验，种子值: 2520155
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 3 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8136
直接模型 - 测试集R²: 0.6319
混合模型 - 测试集R²: 0.8307

==============================
开始第 4/9 次实验，种子值: 2520156
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 4 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7995
直接模型 - 测试集R²: 0.8611
混合模型 - 测试集R²: 0.7138

==============================
开始第 5/9 次实验，种子值: 2520157
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 5 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8171
直接模型 - 测试集R²: 0.2404
混合模型 - 测试集R²: 0.6619

==============================
开始第 6/9 次实验，种子值: 2520158
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 6 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8774
直接模型 - 测试集R²: 0.8806
混合模型 - 测试集R²: 0.8650

==============================
开始第 7/9 次实验，种子值: 2520159
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 7 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7768
直接模型 - 测试集R²: 0.6792
混合模型 - 测试集R²: 0.7106

==============================
开始第 8/9 次实验，种子值: 2520160
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 8 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.7893
直接模型 - 测试集R²: 0.6863
混合模型 - 测试集R²: 0.3797

==============================
开始第 9/9 次实验，种子值: 2520161
==============================
分层抽样验证:
- 分箱数量: 5
  分箱 0: 4 个样本
  分箱 1: 14 个样本
  分箱 2: 6 个样本
  分箱 3: 10 个样本
  分箱 4: 14 个样本

第 9 次实验评估结果（保留4位小数）:
中介模型 - 测试集R²: 0.8464
直接模型 - 测试集R²: 0.8164
混合模型 - 测试集R²: 0.5176

==================================================
多次实验的平均评估结果（保留4位小数）:
==================================================

中介模型 (打印参数→宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 1564.1856
  决定系数 (R2): 0.5830
测试集平均评估:
  均方误差 (MSE): 1322.6073
  决定系数 (R2): 0.7689
  平均绝对误差 (MAE): 23.3305
  中位数绝对误差 (MedAE): 16.8688

直接模型 (打印参数直接→机械模量):
验证集平均评估:
  均方误差 (MSE): 1466.7740
  决定系数 (R2): 0.5746
测试集平均评估:
  均方误差 (MSE): 1781.8841
  决定系数 (R2): 0.6543
  平均绝对误差 (MAE): 27.4029
  中位数绝对误差 (MedAE): 19.8170

混合模型 (打印参数+宽高→机械模量):
验证集平均评估:
  均方误差 (MSE): 1567.1731
  决定系数 (R2): 0.5629
测试集平均评估:
  均方误差 (MSE): 1720.0430
  决定系数 (R2): 0.6585
  平均绝对误差 (MAE): 27.9394
  中位数绝对误差 (MedAE): 23.0180

==================================================
中介效应分析结果:
==================================================
总效应 (直接模型R²): 0.6543
直接效应 (控制宽高后): -0.1104
中介效应 (通过宽高): 0.7647
中介比例 (中介效应/总效应): 116.87%

==================================================
各模型最优参数 (最后一次实验):
==================================================

width模型最优参数:
  colsample_bytree: 1.0
  learning_rate: 0.1
  max_depth: 5
  min_child_weight: 1
  n_estimators: 200
  reg_alpha: 0
  reg_lambda: 0.5
  subsample: 0.8

height模型最优参数:
  colsample_bytree: 1.0
  learning_rate: 0.1
  max_depth: 4
  min_child_weight: 1
  n_estimators: 100
  reg_alpha: 0
  reg_lambda: 1.0
  subsample: 0.8

mediation模型最优参数:
  colsample_bytree: 0.8
  learning_rate: 0.1
  max_depth: 4
  min_child_weight: 1
  n_estimators: 200
  reg_alpha: 0
  reg_lambda: 1.0
  subsample: 1.0

direct模型最优参数:
  colsample_bytree: 1.0
  learning_rate: 0.1
  max_depth: 3
  min_child_weight: 1
  n_estimators: 200
  reg_alpha: 0
  reg_lambda: 0.5
  subsample: 1.0

hybrid模型最优参数:
  colsample_bytree: 0.8
  learning_rate: 0.1
  max_depth: 5
  min_child_weight: 1
  n_estimators: 200
  reg_alpha: 0.1
  reg_lambda: 0.5
  subsample: 1.0

所有预测结果已导出至: prediction_results\XGB_Intermediary_analysis_predictions.xlsx

==================================================
所有实验完成！总运行时间: 1 day, 12:30:12
结束时间: 2025-08-27 07:10:23
详细日志已保存到: outputs\XGB_Intermediary_effect_analysis_log.txt
